---
layout: post
title: Linux常用命令完全指南
date: 2017-08-22 16:21:00
forType: OS
category: Linux
tag: [Linux, 命令行, 系统工具, 系统管理]
---

* content
{:toc}

# Linux常用命令完全指南

本文档汇总了Linux系统中最常用的命令行工具及其使用方法，涵盖系统信息查看、文件操作、用户管理、网络配置、软件包管理等多个方面，是Linux系统管理和日常使用的实用参考手册。

## 一、系统信息查看命令

### 1.1 系统版本信息查看

不同Linux发行版查看系统版本的命令有所不同：

```bash
# Ubuntu/Debian系统查看版本信息（需要安装lsb-release包）
lsb_release -a
# 安装命令（Ubuntu/Debian）
sudo apt-get install lsb-release
# 安装命令（CentOS/RHEL）
sudo yum install redhat-lsb -y

# CentOS/RHEL系统查看版本信息
cat /etc/redhat-release

# 查看系统内核版本
uname -r
uname -a  # 显示更详细的内核信息

# 查看操作系统位数
getconf LONG_BIT

# 查看CPU信息
cat /proc/cpuinfo
lscpu  # 更友好的CPU信息显示
```

### 1.2 系统资源监控

```bash
# 实时监控系统资源使用情况
top  # 显示进程信息和系统资源使用情况
# 常用交互命令：P(按CPU排序)、M(按内存排序)、k(终止进程)、q(退出)

# 更友好的资源监控工具
htop  # 需要安装，提供颜色显示和交互式操作
sudo apt-get install htop  # Ubuntu/Debian安装
sudo yum install htop      # CentOS/RHEL安装

# 查看内存使用情况
free -h  # -h参数以人类可读的方式显示

# 查看磁盘使用情况
df -h  # 显示各分区磁盘使用情况

du -sh *  # 查看当前目录下各文件/目录的大小
du -h --max-depth=1  # 查看当前目录下一级子目录的大小
```

## 二、文件和目录操作命令

### 2.1 基本文件操作

```bash
# 创建目录
mkdir directory_name
mkdir -p parent_dir/child_dir  # 创建多级目录

# 切换目录
cd directory_name
cd ..  # 回到上级目录
cd ~   # 回到当前用户主目录
cd -   # 回到上一次所在目录

# 列出目录内容
ls
ls -la  # 显示所有文件（包括隐藏文件）和详细信息
ls -lh  # 以人类可读的方式显示文件大小
ls -ltr  # 按修改时间倒序排列

# 复制文件或目录
cp source destination
cp -r source_dir destination_dir  # 递归复制目录
cp -v source destination  # 显示复制过程

# 移动或重命名文件/目录
mv old_name new_name
mv -i old_name new_name  # 如有同名文件则提示

# 删除文件
rm file_name
rm -f file_name  # 强制删除，不提示
rm -v file_name  # 显示删除过程

# 删除目录
rm -r directory_name  # 递归删除目录及其内容
rm -rf directory_name  # 强制递归删除，不提示
rm -rv directory_name  # 显示删除过程

# 创建空文件
touch file_name
touch file1 file2 file3  # 同时创建多个空文件
```

### 2.2 文件内容查看

```bash
# 查看文件全部内容
cat file_name
cat -n file_name  # 显示行号
cat file1 file2 > file3  # 将多个文件内容合并到新文件

# 分页查看文件内容
more file_name  # 向前翻页，空格键翻页，Enter键换行
less file_name  # 可向前向后翻页，支持搜索（/搜索词）

# 查看文件开头几行
head file_name  # 默认显示前10行
head -n 20 file_name  # 查看前20行

# 查看文件结尾几行
tail file_name  # 默认显示最后10行
tail -n 20 file_name  # 查看最后20行
tail -f file_name     # 实时查看文件更新（常用于日志监控）
tail -F file_name     # 类似于-f，但会跟踪文件更名或重建

# 搜索文件内容
grep "search_text" file_name
grep -r "search_text" directory_name  # 递归搜索目录中的文件
grep -rn "search_text" directory_name  # 递归搜索并显示行号

grep -n "search_text" file_name  # 显示匹配行的行号
grep -i "search_text" file_name  # 忽略大小写
grep -v "search_text" file_name  # 显示不匹配的行
grep -A 5 "search_text" file_name  # 显示匹配行及其后5行
grep -B 5 "search_text" file_name  # 显示匹配行及其前5行
grep -C 5 "search_text" file_name  # 显示匹配行及其前后各5行

# 结合find和grep搜索文件
find /path/to/search -type f -name "*.txt" -exec grep -l "search_text" {} \;
```

## 三、用户和权限管理命令

### 3.1 用户管理

```bash
# 创建新用户
sudo useradd username
# 创建用户并指定主目录和shell
sudo useradd -d /home/username -s /bin/bash username

# 设置用户密码
sudo passwd username
# 强制用户下次登录时修改密码
sudo passwd -e username

# 删除用户
sudo userdel username
sudo userdel -r username  # 删除用户及其主目录

# 查看当前登录用户
whoami  # 显示当前用户
who  # 显示所有登录用户
last  # 显示用户登录历史

# 切换用户
su - username  # 切换到指定用户并加载其环境变量
sudo command   # 以root权限执行命令
sudo -i  # 切换到root用户环境

# 查看用户所属组
groups username  # 查看指定用户所属组
groups  # 查看当前用户所属组

# 查看用户详细信息
id username
```

### 3.2 权限管理

```bash
# 查看文件/目录权限
ls -l file_name  # 显示详细权限信息
ls -ld directory_name  # 显示目录自身权限而非内容

# 更改文件权限
chmod 755 file_name  # 数字方式设置权限
chmod u+x file_name  # 给文件所有者添加执行权限
chmod g-w file_name  # 移除组的写权限
chmod o=r file_name  # 设置其他用户的只读权限
chmod a+x file_name  # 给所有用户添加执行权限
chmod -R 755 directory_name  # 递归设置目录及其内容权限

# 更改文件所有者
chown user:group file_name

# 更改目录及其内容的所有者和组（递归）
chown -R user:group directory_name
chown -v user:group file_name  # 显示更改过程
```

**权限数字表示法**：
- r（读）= 4
- w（写）= 2
- x（执行）= 1
- 无权限 = 0

权限表示为三组数字，分别对应所有者、组和其他用户的权限。例如：
- 755 表示 rwxr-xr-x（所有者有全部权限，组和其他用户有读和执行权限）
- 644 表示 rw-r--r--（所有者有读写权限，组和其他用户只有读权限）
- 700 表示 rwx------（只有所有者有全部权限）

**目录权限特殊说明**：
- 目录必须有执行权限(x)才能被访问
- 目录有写权限(w)才能在其中创建或删除文件
- 目录有读权限(r)才能列出其内容

## 四、网络相关命令

### 4.1 网络配置和状态

```bash
# 查看网络接口信息
ifconfig  # 传统命令
ethtool eth0  # 查看特定网卡信息（如速度、双工模式等）

# 在新版Linux中推荐使用
ip addr show  # 显示所有网络接口信息
ip link show  # 显示网络链路状态

# 配置网络接口（临时设置）
ifconfig eth0 192.168.1.100 netmask 255.255.255.0
eth0 up  # 启用网卡
eth0 down  # 禁用网卡

# 查看路由表
route -n  # 以数字形式显示路由表
ip route show  # 显示路由表

# 添加和删除路由
route add default gw 192.168.1.1
ip route add 10.0.0.0/8 via 192.168.1.10
ip route del 10.0.0.0/8

# 测试网络连接
ping www.baidu.com  # 测试网络连通性
ping -c 4 www.baidu.com  # 发送4个ICMP包后停止

# 查看DNS配置
cat /etc/resolv.conf

# 域名解析
nslookup www.baidu.com

dig www.baidu.com  # 更详细的DNS查询

# 查看网络连接状态
```bash
# 查看所有网络连接状态
netstat -tuln  # 显示TCP和UDP监听端口
netstat -an    # 显示所有连接和监听端口

# 更强大的网络连接工具
ss -tuln  # 类似netstat但更高效
ss -an    # 显示所有连接

# 查看网络接口流量
iftop  # 需要安装，实时显示网络带宽使用情况
sudo apt-get install iftop  # Ubuntu/Debian安装
sudo yum install iftop      # CentOS/RHEL安装
```

# 网络工具

```bash
netstat -tuln  # 显示所有监听端口
sudo netstat -anp  # 显示所有连接及其进程

# 新版Linux中推荐使用
sudo ss -tuln
```

### 4.2 网络工具

```bash
# 查看DNS配置
cat /etc/resolv.conf

# 测试DNS解析
dig www.baidu.com
nslookup www.baidu.com

traceroute www.baidu.com  # 追踪数据包的路径
sudo apt-get install traceroute  # Ubuntu/Debian安装

telnet hostname port  # 测试远程主机端口是否开放
curl http://www.baidu.com  # 发送HTTP请求
wget http://example.com/file  # 下载文件
```

## 五、包管理命令

### 5.1 Debian/Ubuntu系统（apt包管理）

```bash
# 更新软件包列表
sudo apt-get update

# 升级已安装的软件包
sudo apt-get upgrade
sudo apt-get dist-upgrade  # 智能升级，处理依赖关系变化

# 安装软件包
sudo apt-get install package_name
sudo apt-get install package1 package2  # 同时安装多个软件包

# 卸载软件包
sudo apt-get remove package_name
sudo apt-get purge package_name  # 卸载并删除配置文件

# 搜索软件包
sudo apt-cache search keyword

# 查看软件包信息
sudo apt-cache show package_name

# 清理下载的安装包缓存
sudo apt-get clean
sudo apt-get autoclean

# 自动删除不再需要的依赖包
sudo apt-get autoremove
```

### 5.2 CentOS/RHEL系统（yum包管理）

```bash
# 更新软件包列表
sudo yum update

# 安装软件包
sudo yum install package_name
sudo yum install package1 package2  # 同时安装多个软件包

# 卸载软件包
sudo yum remove package_name

# 搜索软件包
sudo yum search keyword

# 查看软件包信息
sudo yum info package_name

# 列出已安装的软件包
sudo yum list installed

# 清理缓存
sudo yum clean all

# 自动删除不再需要的依赖包
sudo yum autoremove
```

### 5.3 通用包管理（rpm）

```bash
# 安装rpm包
sudo rpm -ivh package.rpm

# 升级rpm包
sudo rpm -Uvh package.rpm

# 卸载rpm包
sudo rpm -e package_name

# 查询已安装的rpm包
sudo rpm -qa | grep keyword

# 查看rpm包信息
sudo rpm -qi package_name
```

## 六、进程管理命令

```bash
# 查看当前运行的进程
ps aux
ps -ef

# 按内存使用排序查看进程
ps aux --sort=-%mem

# 按CPU使用排序查看进程
ps aux --sort=-%cpu

# 杀死进程
kill process_id
kill -9 process_id  # 强制杀死进程

# 根据进程名杀死进程
pkill process_name

# 查找特定进程
sudo pgrep process_name

# 实时监控进程资源使用
top

# 查看进程打开的文件
sudo lsof -p process_id
lsof filename  # 查看哪些进程打开了特定文件
```

## 七、磁盘和文件系统命令

```bash
# 查看磁盘分区
fdisk -l

sudo parted -l  # 更详细的分区信息

# 格式化分区
sudo mkfs.ext4 /dev/sdb1  # 格式化为ext4文件系统
sudo mkfs.xfs /dev/sdb1   # 格式化为xfs文件系统
sudo mkfs.btrfs /dev/sdb1  # 格式化为btrfs文件系统

# 挂载文件系统
sudo mount /dev/sdb1 /mnt
# 指定文件系统类型挂载
sudo mount -t ext4 /dev/sdb1 /mnt

# 卸载文件系统
sudo umount /mnt
# 强制卸载（如果有进程正在使用）
sudo umount -f /mnt

# 查看挂载信息
mount
cat /etc/fstab  # 查看开机自动挂载的文件系统

# 检查磁盘坏道
sudo badblocks -v /dev/sdb

sudo fsck /dev/sdb1  # 检查和修复文件系统错误

# 磁盘性能测试
sudo hdparm -t /dev/sda

iostat  # 查看CPU和磁盘I/O统计信息
```

## 八、文本处理命令

```bash
# 文本排序
sort file_name
sort -n file_name  # 按数字排序
sort -r file_name  # 反向排序

# 去重
uniq file_name
cat file_name | sort | uniq  # 先排序再去重

# 统计行数、字数、字符数
wc file_name
wc -l file_name  # 仅统计行数
wc -w file_name  # 仅统计字数

# 文本替换
sed 's/old_text/new_text/g' file_name
sed -i 's/old_text/new_text/g' file_name  # 直接修改文件

# 文本分割
cut -d',' -f1 file_name  # 以逗号为分隔符，取第一列

# 合并文件
paste file1 file2 > new_file
cat file1 file2 > new_file  # 按顺序连接文件
```

## 九、其他实用命令

### 9.1 系统时间和日期

```bash
# 查看当前时间和日期
date

# 设置系统时间（需要root权限）
sudo date -s "2024-06-16 14:30:00"

# 同步网络时间（Ubuntu/Debian）
sudo apt install ntpdate -y
sudo ntpdate time.windows.com

# 同步网络时间（CentOS/RHEL）
sudo yum install ntpdate -y
sudo ntpdate time.nist.gov

# 查看硬件时钟时间
sudo hwclock

# 同步系统时间到硬件时钟
sudo hwclock -w

# 查看时区设置
timedatectl

# 修改时区
sudo timedatectl set-timezone Asia/Shanghai
```

### 9.2 压缩和解压缩

```bash
# 压缩文件为tar.gz格式
tar -czvf archive.tar.gz directory_name

# 解压缩tar.gz文件
tar -xzvf archive.tar.gz

# 压缩文件为zip格式
zip archive.zip file1 file2 directory1

# 解压缩zip文件
unzip archive.zip

# 压缩/解压缩gzip文件
gzip file_name
gunzip file_name.gz

# 压缩/解压缩bzip2文件
bzip2 file_name
bunzip2 file_name.bz2
```

### 9.3 系统关机和重启

```bash
# 关机
sudo shutdown -h now

sudo poweroff

# 重启
sudo reboot

sudo shutdown -r now

# 定时关机
sudo shutdown -h +60  # 60分钟后关机
sudo shutdown -h 22:00  # 22:00关机

# 取消定时关机
sudo shutdown -c
```

## 十、Shell脚本基础

```bash
# 创建简单的Shell脚本文件（hello.sh）
#!/bin/bash
# 这是一个注释
echo "Hello, World!"

# 为脚本添加执行权限
chmod +x hello.sh

# 运行脚本
./hello.sh
```

### 变量和参数

```bash
#!/bin/bash
# 定义变量
NAME="Linux"
VERSION="5.x"

# 使用变量
echo "系统: $NAME"
echo "版本: $VERSION"

# 命令行参数
# $0 - 脚本名称
# $1, $2... - 第1、2...个参数
# $# - 参数个数
# $* - 所有参数作为一个字符串
# $@ - 所有参数作为单独的字符串

echo "脚本名称: $0"
echo "第一个参数: $1"
echo "参数个数: $#"
echo "所有参数: $@"
```

### 条件判断

```bash
#!/bin/bash
# 条件判断
if [ $# -eq 0 ]; then
echo "请提供一个参数"
exit 1
fi

if [ -f "$1" ]; then
echo "$1 是一个文件"
elif [ -d "$1" ]; then
echo "$1 是一个目录"
else
echo "$1 既不是文件也不是目录"
fi

# 数值比较示例
num1=10
num2=20
if [ $num1 -lt $num2 ]; then
echo "$num1 小于 $num2"
fi

# 字符串比较示例
str1="Linux"
str2="Unix"
if [ "$str1" = "$str2" ]; then
echo "字符串相等"
else
echo "字符串不相等"
fi
```

### 循环

```bash
#!/bin/bash
# for循环
echo "For循环示例:"
for i in 1 2 3 4 5
do
echo "数字: $i"
done

# while循环
echo "\nWhile循环示例:"
counter=1
while [ $counter -le 5 ]
do
echo "计数: $counter"
((counter++))
done
```

## 十一、Linux不同发行版的命令差异说明

### 11.1 包管理差异

| 操作 | Debian/Ubuntu (apt) | CentOS/RHEL (yum) | Arch Linux (pacman) |
|------|---------------------|-------------------|---------------------|
| 更新包列表 | `sudo apt update` | `sudo yum update` | `sudo pacman -Sy` |
| 安装包 | `sudo apt install <pkg>` | `sudo yum install <pkg>` | `sudo pacman -S <pkg>` |
| 卸载包 | `sudo apt remove <pkg>` | `sudo yum remove <pkg>` | `sudo pacman -R <pkg>` |
| 搜索包 | `apt search <term>` | `yum search <term>` | `pacman -Ss <term>` |

### 11.2 服务管理差异

| 操作 | systemd (现代Linux) | SysV init (传统) |
|------|---------------------|-----------------|
| 启动服务 | `sudo systemctl start <service>` | `sudo service <service> start` |
| 停止服务 | `sudo systemctl stop <service>` | `sudo service <service> stop` |
| 重启服务 | `sudo systemctl restart <service>` | `sudo service <service> restart` |
| 查看服务状态 | `sudo systemctl status <service>` | `sudo service <service> status` |
| 开机自启 | `sudo systemctl enable <service>` | `sudo chkconfig <service> on` |
| 禁止开机自启 | `sudo systemctl disable <service>` | `sudo chkconfig <service> off` |

### 11.3 文件系统默认差异

| 发行版 | 默认文件系统 | 备注 |
|--------|--------------|------|
| Ubuntu | ext4 | 较新的版本可能开始使用btrfs |
| CentOS/RHEL | xfs | CentOS 7+默认使用xfs |
| Fedora | btrfs | Fedora 33+默认使用btrfs |
| Arch Linux | ext4 | 安装时可选择其他文件系统 |

### 11.4 防火墙管理差异

| 操作 | Ubuntu (ufw) | CentOS/RHEL (firewalld) |
|------|--------------|-------------------------|
| 查看状态 | `sudo ufw status` | `sudo firewall-cmd --state` |
| 启用防火墙 | `sudo ufw enable` | `sudo systemctl start firewalld` |
| 允许端口 | `sudo ufw allow 80/tcp` | `sudo firewall-cmd --add-port=80/tcp --permanent` |
| 重载配置 | N/A (即时生效) | `sudo firewall-cmd --reload` |

通过本文的介绍，您应该能够掌握Linux系统中最常用的命令及其用法。Linux命令行是系统管理和开发工作的强大工具，熟练掌握这些命令将大大提高您的工作效率。对于不同Linux发行版之间的差异，本文也提供了简要说明，帮助您在不同环境中快速适应。